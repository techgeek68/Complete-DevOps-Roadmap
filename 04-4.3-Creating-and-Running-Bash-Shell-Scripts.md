# 6. Creating and Running Bash Shell Scripts

Bash scripting automates repetitive tasks, chains commands, and adds logic to your workflows. This guide covers script creation, variable usage, control structures, I/O redirection, and more, with clear explanations and copy-ready code blocks.

---

## 1. Variables and User Input

### **Viewing the Value of a Variable**
```
echo $variable_name
```

### **Environmental Variables**
```
echo $HOME
```
```
echo $USER
```
```
echo $PATH
```
```
echo $SHELL
```
```
echo $PWD
```

### **Local Variables**
```
name="phpdev"
```
```
echo "Hello, $name"
```
```
count=10
```
```
echo "Count is $count"
```

### **User Input**
```
read -p "Enter your name: " user_name
echo "Welcome, $user_name!"
```
```
read -p "Enter your age: " age
echo "You are $age years old."
```

---

## 2. Creating and Running a Script

### **Basic Script Structure**

Create a new file:
```
vim scriptexample.sh
```

Script content:
```
#!/bin/bash
echo "Hello, World!"
ls
pwd
```

### **Steps to Run**

Make executable:
```
chmod +x scriptexample.sh
```

Run:
```
./scriptexample.sh
```

---

## 3. Setting Scripts on the PATH

### **Making a Script Globally Accessible**

Create a script directory:
```
mkdir myscript
```
```
cd myscript
```
```
vim mytask.sh
```

Script content:
```
#!/bin/bash
echo "Currently logged in users are:"
who
echo "Memory Status"
free -h
echo "Disk info"
df -h
```

Make executable:
```
chmod +x mytask.sh
```
```
ls
```
```
cd
```

Add script directory to PATH (user only):
```
vim .bashrc
```
```
export PATH=$PATH:~/myscript
```
```
source .bashrc
```
```
mytask.sh
```

System-wide (for root):
```
vim /etc/profile
```
Add:
```
export PATH=$PATH:/home/yourusername/myscript
```
Reload:
```
source /etc/profile
```

---

## 4. Reading Input

```
read -p "Enter your age: " age
echo "You are $age years old."
```
```
read -sp "Enter your password: " password
echo -e "\nPassword received."
```
```
read -p "Enter filename: " filename
cat $filename
```

---

## 5. Conditionals

### **if Statement**
```
read -p "Enter your age: " age
if [ $age -ge 18 ]; then
  echo "You are an adult."
elif [ $age -ge 13 ]; then
  echo "You are a teenager."
else
  echo "You are a child."
fi
```

#### **String Comparison Example**
```
read -p "Enter yes or no: " answer
if [ "$answer" = "yes" ]; then
  echo "Affirmative."
else
  echo "Negative or unknown."
fi
```

### **case Statement**
```
case $1 in
  start)
    echo "Starting service..."
    ;;
  stop)
    echo "Stopping service..."
    ;;
  restart)
    echo "Restarting service..."
    ;;
  *)
    echo "Usage: $0 {start|stop|restart}"
    ;;
esac
```

Run in terminal:
```
./casestatement.sh start
```
```
./casestatement.sh stop
```
```
./casestatement.sh restart
```

---

## 6. Loops

### **for Loop**

**List Example:**
```
for fruit in apple banana cherry; do
  echo "Fruit: $fruit"
done
```

**Numeric Range Example:**
```
for i in {1..5}; do
  echo "Number: $i"
done
```

**Iterate Files in Directory:**
```
for file in *.txt; do
  echo "Found file: $file"
done
```

### **while Loop**
```
count=1
while [ $count -le 5 ]; do
  echo "Count: $count"
  ((count++))
done
```
**Wait for File Example:**
```
while [ ! -f myfile.txt ]; do
  sleep 1
done
echo "myfile.txt is now present."
```

### **until Loop**
```
count=1
until [ $count -gt 10 ]; do
  echo "Count: $count"
  ((count++))
done
```

---

## 7. Functions

**Basic Function:**
```
greet_user() {
  echo "Hello, $1 $2!"
}
greet_user "Ram" "Bahadur"
```

**Return Value Example:**
```
add_numbers() {
  local sum=$(($1 + $2))
  echo $sum
}
result=$(add_numbers 5 7)
echo "Sum is $result"
```

---

## 8. Environment Variables

### **Predefined Variables**
```
echo "User: $USER"
```
```
echo "Home: $HOME"
```
```
echo "Path: $PATH"
```
```
echo "Script name: $0"
```
```
echo "First argument: $1"
```
```
echo "Number of arguments: $#"
```
```
echo "All arguments: $@"
```

### **Export Variables (for subprocesses)**
```
export MY_VAR="value"
```
```
bash -c 'echo $MY_VAR'
```

---

## 9. I/O Redirection and Pipelines

### **Redirection**

Overwrite file:
```
echo "Hello" > output.txt
```

Append to file:
```
echo "World" >> output.txt
```

Read from file:
```
cat < input.txt
```

Redirect stderr:
```
ls /nonexistent 2> error.log
```

Redirect stdout and stderr:
```
ls /nonexistent &> all.log
```

Send output to null (ignore output):
```
command > /dev/null 2>&1
```

### **Pipelines**

Chain commands:
```
ls -l | grep ".txt" | wc -l
```
```
cat /etc/passwd | grep "/bin/bash"
```
```
ps aux | sort -rk 3,3 | head -n 5
```
```
df -h | grep "/dev/sda"
```

---

## 10. Debugging Scripts

Enable debug mode to trace execution:
```
bash -x myscript.sh
```

Add set -x inside the script for partial tracing:
```
#!/bin/bash
set -x
echo "Debugging enabled"
ls
set +x
echo "Debugging disabled"
```

---

## 11. Script Arguments

Access script arguments:
```
echo "First argument: $1"
echo "Second argument: $2"
echo "Number of arguments: $#"
echo "All arguments: $@"
```

Loop through all arguments:
```
for arg in "$@"; do
  echo "Arg: $arg"
done
```

---

## 12. Exit Status

Check exit status of last command:
```
ls /tmp
echo $?
```
Use exit in scripts:
```
if [ ! -f "$1" ]; then
  echo "File not found!"
  exit 1
fi
```

---

**Tip:** Practice scripting in a test environment. Use `man bash` and `help <command>` for more details.
